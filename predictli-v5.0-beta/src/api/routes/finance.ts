import { Router } from 'express'; import { db } from '../../db/index.js'; import { fin_ledger } from '../../db/schema.js'; export const finance=Router(); finance.post('/finance/record', async (req,res)=>{ const {event,amount_aud,meta}=req.body||{}; if(!event||typeof amount_aud!=='number') return res.status(400).json({error:'event and amount_aud required'}); const [row]=await db.insert(fin_ledger).values({ event, amount_aud, meta: JSON.stringify(meta||{}) }).returning(); res.json({ id: row.id }); });
